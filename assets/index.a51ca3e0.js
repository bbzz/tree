import{d as e,c as t,w as n,v as r,r as l,a as i,o as a,b as o}from"./vendor.4b97d5d8.js";function d(){let e="";return e+=c((new Date).getTime(),8),e+=c(Math.ceil(Math.random()*62**6),6),e}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(e,t){let n="";for(let r=0;r<t;r++)n=s[e%s.length]+n,e=Math.floor(e/s.length);return n}function u(){return{id:d(),title:"",editTime:Date.now(),children:[]}}const f=e({name:"Tree",props:{data:{type:Object,required:!0},index:{type:Number,default:0}},emits:["insertSiblingNode","deleteCurrentNode"],directives:{focus:{mounted(e){e.focus()}}},setup(e,{emit:i}){const a=(t,n)=>{var r;null==(r=e.data.children)||r.splice(n?t:t+1,0,u())},o=t=>{var n;null==(n=e.data.children)||n.splice(t,1)};return()=>{var d;return t("div",{class:"node"},[t("div",{class:"root"},[n(t("input",{"onUpdate:modelValue":t=>e.data.title=t,onKeydown:t=>((e,t,n)=>{var r;if("Enter"===e.key){const t=e.shiftKey;i("insertSiblingNode",n,t)}else{if("Tab"===e.key)return e.target.blur(),t.children||(t.children=[]),t.children.push(u()),e.preventDefault(),!1;"Backspace"===e.key&&e.metaKey&&((null==(r=t.children)?void 0:r.length)?console.warn("含有子元素不能删除"):i("deleteCurrentNode",n))}})(t,e.data,e.index)},null),[[r,e.data.title],[l("focus")]])]),e.data.children&&e.data.children.length?t("ul",{class:["leaf",{one:1===e.data.children.length}]},[null==(d=e.data.children)?void 0:d.map(((e,n)=>t("li",{key:e.id},[t(f,{data:e,index:n,onInsertSiblingNode:a,onDeleteCurrentNode:o},null)])))]):null])}}});var m={id:d(),title:"",editTime:0,children:[]};var p="_container_11tig_1";o({setup(){const e=i(null),n=i(m),r=localStorage.getItem("__knowData");if(r){const e=JSON.parse(r);e.editTime,n.value=e}return setInterval((()=>{console.info("自动保存到本地",Date.now()),n.value.editTime=Date.now(),localStorage.setItem("__knowData",JSON.stringify(n.value))}),1e4),window.addEventListener("keydown",(function(e){"KeyS"===e.code&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),n.value.editTime=Date.now(),localStorage.setItem("__knowData",JSON.stringify(n.value)),alert("保存成功"))}),!1),a((()=>{e.value&&(e.value.className=p)})),()=>t("div",{ref:e},[t(f,{data:n.value},null)])}}).mount("#app");
